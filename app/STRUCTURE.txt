Influencers Platform - Estructura del Proyecto
==============================================

Influencers/
â”‚
â”œâ”€â”€ ğŸ“„ Archivos de ConfiguraciÃ³n RaÃ­z
â”‚   â”œâ”€â”€ .env.example              # Template de variables de entorno
â”‚   â”œâ”€â”€ .gitignore                # Archivos ignorados por Git
â”‚   â”œâ”€â”€ alembic.ini               # ConfiguraciÃ³n de Alembic (migraciones)
â”‚   â”œâ”€â”€ docker-compose.yml        # OrquestaciÃ³n de servicios Docker
â”‚   â”œâ”€â”€ Dockerfile                # Imagen Docker multi-stage
â”‚   â”œâ”€â”€ Makefile                  # Comandos Ãºtiles de desarrollo
â”‚   â”œâ”€â”€ pytest.ini                # ConfiguraciÃ³n de pytest
â”‚   â””â”€â”€ requirements.txt          # Dependencias de Python
â”‚
â”œâ”€â”€ ğŸ“š DocumentaciÃ³n
â”‚   â”œâ”€â”€ README.md                 # DocumentaciÃ³n principal completa
â”‚   â”œâ”€â”€ QUICKSTART.md             # GuÃ­a de inicio rÃ¡pido (5 min)
â”‚   â”œâ”€â”€ DEPLOYMENT.md             # GuÃ­a de despliegue a producciÃ³n
â”‚   â”œâ”€â”€ PROJECT_SUMMARY.md        # Resumen ejecutivo del proyecto
â”‚   â”œâ”€â”€ COMMANDS.md               # Cheat sheet de comandos Ãºtiles
â”‚   â””â”€â”€ STRUCTURE.txt             # Este archivo
â”‚
â”œâ”€â”€ ğŸ—„ï¸ alembic/                  # Migraciones de Base de Datos
â”‚   â”œâ”€â”€ README                    # Info de Alembic
â”‚   â”œâ”€â”€ env.py                    # ConfiguraciÃ³n async de migraciones
â”‚   â”œâ”€â”€ script.py.mako            # Template para nuevas migraciones
â”‚   â””â”€â”€ versions/                 # Carpeta de migraciones (generadas)
â”‚
â”œâ”€â”€ ğŸ app/                       # CÃ³digo Principal de la AplicaciÃ³n
â”‚   â”‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                   # â­ Punto de entrada FastAPI
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”§ core/                  # ConfiguraciÃ³n Central
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py             # Settings con Pydantic
â”‚   â”‚   â”œâ”€â”€ database.py           # SQLAlchemy async + sessions
â”‚   â”‚   â””â”€â”€ security.py           # JWT + password hashing
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ—ƒï¸ models/                # Modelos de SQLAlchemy
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user.py               # Usuario (EMPRESA, INFLUENCER, ADMIN)
â”‚   â”‚   â”œâ”€â”€ profile.py            # Perfil de influencer
â”‚   â”‚   â”œâ”€â”€ campaign.py           # CampaÃ±as de marketing
â”‚   â”‚   â”œâ”€â”€ payment.py            # Pagos y comisiones
â”‚   â”‚   â”œâ”€â”€ notification.py       # Sistema de notificaciones
â”‚   â”‚   â”œâ”€â”€ message.py            # MensajerÃ­a interna
â”‚   â”‚   â””â”€â”€ subscription.py       # Suscripciones de empresas
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‹ schemas/               # Schemas de Pydantic (ValidaciÃ³n)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user_schemas.py       # ValidaciÃ³n de usuarios
â”‚   â”‚   â”œâ”€â”€ profile_schemas.py    # ValidaciÃ³n de perfiles
â”‚   â”‚   â”œâ”€â”€ campaign_schemas.py   # ValidaciÃ³n de campaÃ±as
â”‚   â”‚   â”œâ”€â”€ payment_schemas.py    # ValidaciÃ³n de pagos
â”‚   â”‚   â”œâ”€â”€ notification_schemas.py
â”‚   â”‚   â””â”€â”€ message_schemas.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ—‚ï¸ repositories/          # PatrÃ³n Repository (Acceso a Datos)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ user_repository.py    # CRUD de usuarios
â”‚   â”‚   â”œâ”€â”€ profile_repository.py # CRUD de perfiles
â”‚   â”‚   â”œâ”€â”€ campaign_repository.py
â”‚   â”‚   â”œâ”€â”€ payment_repository.py
â”‚   â”‚   â”œâ”€â”€ notification_repository.py
â”‚   â”‚   â””â”€â”€ message_repository.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ’¼ services/              # LÃ³gica de Negocio
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth_service.py       # AutenticaciÃ³n y registro
â”‚   â”‚   â”œâ”€â”€ trial_service.py      # â­â­â­ LÃ“GICA CRÃTICA DEL TRIAL
â”‚   â”‚   â”œâ”€â”€ campaign_service.py   # GestiÃ³n de campaÃ±as
â”‚   â”‚   â”œâ”€â”€ payment_service.py    # Procesamiento de pagos
â”‚   â”‚   â””â”€â”€ notification_service.py
â”‚   â”‚
â”‚   â””â”€â”€ ğŸŒ api/                   # Routers de FastAPI (Endpoints)
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ dependencies.py       # â­ Auth + Middleware de Trial
â”‚       â”œâ”€â”€ auth.py               # POST /auth/register, /auth/login
â”‚       â”œâ”€â”€ users.py              # GET /users/me, /users/trial-status
â”‚       â”œâ”€â”€ profiles.py           # â­ GET /profiles/{id} (con trial)
â”‚       â”œâ”€â”€ campaigns.py          # POST /campaigns, /campaigns/{id}/accept
â”‚       â”œâ”€â”€ payments.py           # POST /payments
â”‚       â””â”€â”€ notifications.py      # GET /notifications
â”‚
â”œâ”€â”€ ğŸ§ª tests/                     # Suite de Pruebas
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py               # Fixtures y configuraciÃ³n async
â”‚   â”‚
â”‚   â”œâ”€â”€ unit/                     # Pruebas Unitarias
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ test_trial_logic.py   # â­â­â­ 12 PRUEBAS CRÃTICAS DEL TRIAL
â”‚   â”‚
â”‚   â””â”€â”€ integration/              # Pruebas de IntegraciÃ³n
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ test_auth_api.py      # 10 pruebas de endpoints de auth
â”‚
â””â”€â”€ ğŸ”§ scripts/                   # Scripts de Utilidad
    â”œâ”€â”€ init_db.py                # Inicializar DB con admin user
    â”œâ”€â”€ run_tests.sh              # Script de tests (Linux/Mac)
    â””â”€â”€ run_tests.ps1             # Script de tests (Windows)


ARQUITECTURA EN CAPAS
=====================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Layer (FastAPI Routers)      â”‚  â† HTTP Endpoints
â”‚   app/api/*.py                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Service Layer (Business Logic)   â”‚  â† LÃ³gica de Negocio
â”‚   app/services/*.py                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Repository Layer (Data Access)   â”‚  â† Acceso a Datos
â”‚   app/repositories/*.py             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Model Layer (SQLAlchemy ORM)     â”‚  â† Modelos de DB
â”‚   app/models/*.py                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


FLUJO DE UNA REQUEST
====================

1. Cliente â†’ HTTP Request â†’ FastAPI Router (app/api/*.py)
                                    â†“
2. Dependency Injection â†’ get_current_user, check_trial_access
                                    â†“
3. Service Layer â†’ LÃ³gica de Negocio (app/services/*.py)
                                    â†“
4. Repository Layer â†’ Queries a DB (app/repositories/*.py)
                                    â†“
5. Model Layer â†’ SQLAlchemy ORM (app/models/*.py)
                                    â†“
6. PostgreSQL Database
                                    â†“
7. Response â† Pydantic Schema (app/schemas/*.py)
                                    â†“
8. Cliente â† HTTP Response (JSON)


ENDPOINTS PRINCIPALES
=====================

AutenticaciÃ³n:
  POST   /auth/register          # Registro de usuario
  POST   /auth/login             # Login (retorna JWT)

Usuarios:
  GET    /users/me               # Info del usuario actual
  GET    /users/trial-status     # Estado del trial (EMPRESA)
  PATCH  /users/{id}/approve     # Aprobar usuario (ADMIN)

Perfiles:
  POST   /profiles/              # Crear perfil (INFLUENCER)
  GET    /profiles/              # Listar perfiles
  GET    /profiles/{id}          # â­ Ver perfil (CON LÃ“GICA DE TRIAL)
  PUT    /profiles/me            # Actualizar mi perfil

CampaÃ±as:
  POST   /campaigns/             # Crear propuesta (EMPRESA)
  GET    /campaigns/             # Mis campaÃ±as
  GET    /campaigns/{id}         # Ver campaÃ±a
  POST   /campaigns/{id}/accept  # Aceptar (INFLUENCER)
  POST   /campaigns/{id}/reject  # Rechazar (INFLUENCER)
  POST   /campaigns/{id}/negotiate # Negociar (INFLUENCER)
  POST   /campaigns/{id}/complete  # Completar (EMPRESA/ADMIN)

Pagos:
  POST   /payments/              # Crear pago (EMPRESA)
  GET    /payments/              # Mis pagos
  POST   /payments/{id}/complete # Liberar pago (ADMIN)

Notificaciones:
  GET    /notifications/         # Mis notificaciones
  PATCH  /notifications/{id}/read # Marcar como leÃ­da


MODELOS DE BASE DE DATOS
=========================

users
â”œâ”€â”€ id (PK)
â”œâ”€â”€ email (unique)
â”œâ”€â”€ hashed_password
â”œâ”€â”€ full_name
â”œâ”€â”€ role (EMPRESA | INFLUENCER | ADMIN)
â”œâ”€â”€ is_active
â”œâ”€â”€ is_approved
â”œâ”€â”€ trial_start_time â­
â”œâ”€â”€ trial_profile_viewed_id â­
â”œâ”€â”€ has_active_subscription â­
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

influencer_profiles
â”œâ”€â”€ id (PK)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ bio
â”œâ”€â”€ instagram_handle
â”œâ”€â”€ instagram_followers
â”œâ”€â”€ tiktok_handle
â”œâ”€â”€ youtube_handle
â”œâ”€â”€ suggested_rate_per_post
â”œâ”€â”€ average_engagement_rate
â”œâ”€â”€ total_campaigns_completed
â””â”€â”€ average_rating

campaigns
â”œâ”€â”€ id (PK)
â”œâ”€â”€ empresa_id (FK â†’ users)
â”œâ”€â”€ influencer_id (FK â†’ users)
â”œâ”€â”€ title
â”œâ”€â”€ description
â”œâ”€â”€ proposed_budget
â”œâ”€â”€ final_budget
â”œâ”€â”€ status (PENDIENTE | ACTIVA | FINALIZADA | etc.)
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

payments
â”œâ”€â”€ id (PK)
â”œâ”€â”€ campaign_id (FK â†’ campaigns)
â”œâ”€â”€ empresa_id (FK â†’ users)
â”œâ”€â”€ influencer_id (FK â†’ users)
â”œâ”€â”€ amount
â”œâ”€â”€ platform_commission â­
â”œâ”€â”€ influencer_payout â­
â”œâ”€â”€ stripe_payment_intent_id
â”œâ”€â”€ status (PENDIENTE | RETENIDO | COMPLETADO)
â””â”€â”€ created_at

notifications
â”œâ”€â”€ id (PK)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ title
â”œâ”€â”€ message
â”œâ”€â”€ notification_type
â”œâ”€â”€ is_read
â””â”€â”€ created_at

messages
â”œâ”€â”€ id (PK)
â”œâ”€â”€ campaign_id (FK â†’ campaigns)
â”œâ”€â”€ sender_id (FK â†’ users)
â”œâ”€â”€ receiver_id (FK â†’ users)
â”œâ”€â”€ content
â””â”€â”€ created_at

subscriptions
â”œâ”€â”€ id (PK)
â”œâ”€â”€ user_id (FK â†’ users)
â”œâ”€â”€ plan_name
â”œâ”€â”€ monthly_fee
â”œâ”€â”€ stripe_subscription_id
â”œâ”€â”€ status (ACTIVA | CANCELADA | EXPIRADA)
â”œâ”€â”€ current_period_start
â””â”€â”€ current_period_end


LÃ“GICA DE NEGOCIO CRÃTICA
==========================

â­â­â­ TRIAL DE 24 HORAS (MVP Feature)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
UbicaciÃ³n: app/services/trial_service.py
           app/api/dependencies.py (middleware check_trial_access)

Reglas:
1. EMPRESA se registra â†’ trial_start_time = NOW
2. Durante 24 horas puede ver 1 perfil completo
3. Primer perfil â†’ PERMITIDO + guardar en trial_profile_viewed_id
4. Segundo perfil diferente â†’ BLOQUEADO (HTTP 403)
5. Mismo perfil â†’ PERMITIDO (puede ver mÃºltiples veces)
6. DespuÃ©s de 24 horas â†’ BLOQUEADO (HTTP 402)
7. Con suscripciÃ³n â†’ ACCESO ILIMITADO

Endpoint Afectado:
  GET /profiles/{id} â† Aplica middleware check_trial_access

Pruebas:
  tests/unit/test_trial_logic.py (12 pruebas)


STACK TECNOLÃ“GICO
=================

Backend Framework:    FastAPI 0.104.1
Base de Datos:        PostgreSQL 15
ORM:                  SQLAlchemy 2.0 (async)
ValidaciÃ³n:           Pydantic 2.5
AutenticaciÃ³n:        JWT (python-jose)
Password Hashing:     Passlib + bcrypt
Migraciones:          Alembic
Testing:              pytest + pytest-asyncio + httpx
Pagos:                Stripe (mock en MVP)
Servidor ASGI:        Uvicorn + Gunicorn
ContainerizaciÃ³n:     Docker + Docker Compose


COMANDOS RÃPIDOS
================

# Levantar proyecto
docker-compose up --build

# Ejecutar migraciones
docker-compose exec api alembic upgrade head

# Inicializar DB
docker-compose exec api python scripts/init_db.py

# Ejecutar tests
docker-compose exec api pytest

# Ver documentaciÃ³n
http://localhost:8000/docs

# Ver logs
docker-compose logs -f api


ARCHIVOS CLAVE
==============

â­â­â­ MÃS IMPORTANTES:
  app/services/trial_service.py       # LÃ³gica del trial
  app/api/dependencies.py             # Middleware de trial
  tests/unit/test_trial_logic.py      # Pruebas del trial
  app/main.py                         # Entry point
  docker-compose.yml                  # OrquestaciÃ³n

â­â­ IMPORTANTES:
  app/models/user.py                  # Modelo de usuario
  app/services/campaign_service.py    # LÃ³gica de campaÃ±as
  app/services/payment_service.py     # LÃ³gica de pagos
  app/api/profiles.py                 # Endpoints de perfiles

â­ ÃšTILES:
  README.md                           # DocumentaciÃ³n completa
  QUICKSTART.md                       # Inicio rÃ¡pido
  DEPLOYMENT.md                       # GuÃ­a de despliegue


PRÃ“XIMOS PASOS
==============

1. Levantar el proyecto:
   docker-compose up --build

2. Ejecutar migraciones:
   docker-compose exec api alembic upgrade head

3. Inicializar datos:
   docker-compose exec api python scripts/init_db.py

4. Abrir documentaciÃ³n:
   http://localhost:8000/docs

5. Ejecutar pruebas:
   docker-compose exec api pytest -v

6. Leer README.md para mÃ¡s detalles


CREDENCIALES POR DEFECTO
=========================

Admin:
  Email: admin@influencers.com
  Password: admin123
  âš ï¸ CAMBIAR EN PRODUCCIÃ“N


ESTADO DEL PROYECTO
===================

âœ… MVP COMPLETADO AL 100%
âœ… Toda la lÃ³gica de negocio implementada
âœ… Pruebas unitarias e integraciÃ³n
âœ… DocumentaciÃ³n completa
âœ… Dockerizado y listo para producciÃ³n

Â¡Listo para desarrollar! ğŸš€
